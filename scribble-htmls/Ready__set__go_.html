<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>5&nbsp;Ready, set, go!</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {
  document.write('<link rel="stylesheet" href="katex/katex.min.css" />');
})();(function() {document.write('<scr' + 'ipt type="text/javascript" src="katex/katex.min.js"></scr' + 'ipt>');})();(function(f) {
  // A "simple" onLoad function
  if (window.document.readyState == "complete") {
    f();
  } else if (window.document.addEventListener) {
    window.document.addEventListener("DOMContentLoaded", f, false);
  } else if (window.attachEvent) {
    window.attachEvent("onreadystatechange", function() {
      if (window.document.readyState == "complete") {
        f();
      }
    });
  } else {
    var oldLoad = window.onload;
    if (typeof(oldLoad) == "function") {
      window.onload = function() {
        try {
          oldLoad();
        } finally {
          f();
        }
      };
    } else {
      window.onload = f;
    }
  }
})(function() {
  // This is an ugly way to change the doctype, in case the scribble document
  // did not use (with-html5).
  if (!(document.doctype && document.doctype.publicId == '')) {
    if (console && console.log) {
      console.log("Re-wrote the document to use the HTML5 doctype.\n"
                  + "  Consider using the following declaration:\n"
                  + "      @title[#:style (with-html5 manual-doc-style)]{â€¦}");
    }
    var wholeDoc = '<!doctype HTML>\n' + document.documentElement.outerHTML;
    document.open();
    document.clear();
    document.write(wholeDoc);
  }
  var inlineElements = document.getElementsByClassName("texMathInline");
  for (var i = 0; i < inlineElements.length; i++) {
    var e = inlineElements[i];
    katex.render(e.textContent, e, { displayMode:false, throwOnError:false });
  }
  var displayElements = document.getElementsByClassName("texMathDisplay");
  for (var i = 0; i < displayElements.length; i++) {
    var e = displayElements[i];
    katex.render(e.textContent, e, { displayMode:true, throwOnError:false });
  }
});
</script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Relation Drag Racing</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="The_straightforward_approach.html" class="tocviewlink" data-pltdoc="x">The straightforward approach</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Exploiting_the_structure_of_multiples_of_3.html" class="tocviewlink" data-pltdoc="x">Exploiting the structure of multiples of 3</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Enumerating_all_multiples_of_3.html" class="tocviewlink" data-pltdoc="x">Enumerating all multiples of 3</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Start_your_engines.html" class="tocviewlink" data-pltdoc="x">Start your engines</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Ready, set, go!</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Start_your_engines.html" title="backward to &quot;4 Start your engines&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Relation Drag Racing&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h3>5<tt>&nbsp;</tt><a name="(part._.Ready__set__go_)"></a>Ready, set, go!</h3><p><img src="divisibility-by-3-all-results.png" alt="" width="756" height="425"/></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktSym">n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">3n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">dfa</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">enum</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">n3</span></p></td></tr><tr><td><p>250</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>76</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>8</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>889</p></td></tr><tr><td><p>500</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>168</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>112</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>3790</p></td></tr><tr><td><p>750</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>410</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>59</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>8309</p></td></tr><tr><td><p>1000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>468</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>54</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>18165</p></td></tr><tr><td><p>1250</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1033</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>68</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>22868</p></td></tr><tr><td><p>1500</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1042</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>123</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>31357</p></td></tr><tr><td><p>1750</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1036</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>136</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>3</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>42626</p></td></tr><tr><td><p>2000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1153</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>130</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>3</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>58484</p></td></tr></table></p><p><span class="RktSym">3n</span> is doing horribly. What takes <span class="RktSym">enum</span> a handful of miliseconds takes nearly a minute for <span class="RktSym">3n</span>. I&rsquo;ll have to stop measuring <span class="RktSym">3n</span> for higher values if I want to see real differences between the other 3 implementations. One easy takeaway is that if you&rsquo;re comfortable doing a divisibility against a constant value by using the existential approach with <span class="RktSym">*o</span>, make sure the constant is the first value, not the second! It makes a huge difference.</p><p>Continuing on without <span class="RktSym">3n</span> for higher values of <span class="RktSym">n</span>.</p><p><img src="divisibility-by-3-narrowed-results.png" alt="" width="756" height="425"/></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktSym">n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">3n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">dfa</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">enum</span></p></td></tr><tr><td><p>5000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>8342</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>383</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>8</p></td></tr><tr><td><p>10000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>14033</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1040</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>20</p></td></tr><tr><td><p>15000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>15919</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1858</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>27</p></td></tr><tr><td><p>20000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>33743</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>2023</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>38</p></td></tr><tr><td><p>25000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>35274</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>5149</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>58</p></td></tr><tr><td><p>30000</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>37538</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>5314</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>85</p></td></tr></table></p><p>So it looks like enum is the best choice, but that&rsquo;s only for generating values from a fresh variable. What if you want to use the relation to test if an already-fully-ground value is divisible by 3?</p><p>Here is the code template for the next drag race. Here we just want to find one answer, <span class="RktPn">(</span><span class="RktVar">.0</span><span class="RktPn">)</span>, to indicate that the number <span class="RktSym">x</span>, (some variation of 999...) is indeed a multiple of 3.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">time</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">q</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">multiple-of-3o-enum</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">build-num</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote><p><img src="divisibility-by-3-all-ground.png" alt="" width="756" height="425"/></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktSym">x</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">3n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">dfa</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">enum</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">n3</span></p></td></tr><tr><td><p>9</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td></tr><tr><td><p>99</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>7</p></td></tr><tr><td><p>999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>775</p></td></tr><tr><td><p>9999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>2</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>1</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>82604</p></td></tr></table></p><p><span class="RktSym">n3</span> is doing even worse now at recognizing than it was at generating. Continuing without <span class="RktSym">n3</span>:</p><p><img src="divisibility-by-3-narrowed-ground.png" alt="" width="756" height="425"/></p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktSym">x</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">3n</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">dfa</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="RktSym">enum</span></p></td></tr><tr><td><p>99999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>4</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>18</p></td></tr><tr><td><p>999999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>10</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>163</p></td></tr><tr><td><p>9999999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>14</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>2329</p></td></tr><tr><td><p>99999999</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>23</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>26567</p></td></tr></table></p><p>But now at higher values of <span class="RktSym">x</span>, <span class="RktSym">enum</span> starts to do badly! That is becasue it fully enumerates every multiple of 3 in order, and there are many, many multiples of 3 that come before 99999999. <span class="RktSym">dfa</span> remains speedy because it actually explores the Oleg number it is given, so its runtime depends only on the bitlength of the Oleg number rather than the value, which can be up to <span class="texMathInline">2^n</span> for some bitlength <span class="texMathInline">n</span>. <span class="RktSym">3n</span> also seems to be faring fine, which surprised me.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Start_your_engines.html" title="backward to &quot;4 Start your engines&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Relation Drag Racing&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>